***************
*** 547,559 ****
  
  StoredDiagnostic::StoredDiagnostic() { }
  
- StoredDiagnostic::StoredDiagnostic(Diagnostic::Level Level, 
                                     llvm::StringRef Message)
-   : Level(Level), Loc(), Message(Message) { }
  
  StoredDiagnostic::StoredDiagnostic(Diagnostic::Level Level, 
                                     const DiagnosticInfo &Info)
-   : Level(Level) {
    assert((Info.getLocation().isInvalid() || Info.hasSourceManager()) &&
         "Valid source location without setting a source manager for diagnostic");
    if (Info.getLocation().isValid())
--- 547,560 ----
  
  StoredDiagnostic::StoredDiagnostic() { }
  
+ StoredDiagnostic::StoredDiagnostic(Diagnostic::Level Level, unsigned ID,
                                     llvm::StringRef Message)
+   : Level(Level), ID(ID), Loc(), Message(Message) { }
  
  StoredDiagnostic::StoredDiagnostic(Diagnostic::Level Level, 
                                     const DiagnosticInfo &Info)
+   : ID(Info.getID()), Level(Level) 
+ {
    assert((Info.getLocation().isInvalid() || Info.hasSourceManager()) &&
         "Valid source location without setting a source manager for diagnostic");
    if (Info.getLocation().isValid())
